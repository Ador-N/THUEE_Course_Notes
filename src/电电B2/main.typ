#import "template.typ": *

#show: project.with(
  title: "电电复习笔记",
  authors: ("无34 gx",),
  date: "January 3, 2025",
)

#let matsmall(content) = text(math.display(content), size: 9pt)

= 线性电路
== 网络参量
- $z,y,h,g,"ABCD","abcd"$
$ &vec(v_1, v_2)=mat(z_11, z_12; z_21, z_22) vec(i_1, i_2)& space.quad vec(i_1, i_2)=mat(y_11, y_12; y_21, y_22) vec(v_1, v_2)\
&vec(v_1, i_2)=mat(h_11, h_12; h_21, h_22) vec(i_1, v_2)& space.quad vec(i_1, v_2)=mat(g_11, g_12; g_21, g_22) vec(v_1, i_2)\
&vec(v_1, i_i)=mat(A, B; C, D) vec(v_2, i_2)& space.quad (vec(v_2, i_2)=mat(a, b; c, d) vec(v_1, i_1)) $
- $z=y^(-1), h=g^(-1), "ABCD" = "abcd"^(-1)$
- $z_21=1/C$ 跨阻增益，$y_21=-1/B$ 跨导增益, $h_21=-1/D$ 电流增益, $g_21=1/A$ 电压增益
- $p_"in" = p_11-(p_12p_21)/(p_22+P_L), p_"out" = p_22-(p_12p_21)/(p_11+P_S)$
$ H_v=(z_21R_L | y_21G_S | h_21 | g_21 R_L G_S)/(p_12 p_21-(p_11+P_S)(p_22+P_L)) "（量纲分析即可）" $
- 串串连接z相加，并并连接y相加，串并连接h相加，并串连接g相加
- 串臂元件 $"ABCD" = mat(1,z;0,1)$，并臂元件 $"ABCD" = mat(1,0;y,1)$，级联按顺序相乘
- 单向：$p_12=0$, $|"ABCD"|=0$；近似的单向化条件：$|p_12p_21|<<|(p_11+P_S)(p_22+P_L)|$\
  互易：$z, y$ 对称、$h, g$ 反对称、$|"ABCD"|=1$；线性时不变阻/容/感构成的网络一定互易\
  对称：互易且 $z slash y_11=z slash y_22, Delta_(h slash g)=1,A=D$ \
  _有源_：$&Re(p_11)<0 or Re(p_22)<0$#h(1.8em)（负阻有源性）\
  #h(3em)$&|p_12+p_21^*|^2>4Re(p_11)Re(p_22)$（受控源有源性）\
  #h(3em)（总之即 $p+p^H$ 非半正定）
== 一些线性元件
- *变压器*
 - 匝数比 $n:1$ 理想变压器 $"ABCD" = mat(n, 0; 0, 1/n), h = mat(0, n; -n, 0)$
 - 互感变压器，两端 $L_1, L_2$, 匝数比 $n=sqrt(L_1 slash L_2)$，互感 $M=k sqrt(L_1L_2)$，耦合系数 $k in [-1, 1]$,\
   $z = j omega mat(L_1, M; M, L_2)=j omega sqrt(L_1L_2) mat(n, k; k, 1/n)$, $|k|=1$ 时为全耦合，进一步 $L->infinity$ 抽象为理想变压器
- *回旋器*
 - $z=mat(0,-r_1; r_2, 0), T=mat(0, r_1; g_2, 0)$，$r_1=r_2=r$ 时无损无源，为理想回旋器，实现对偶变换
- *阻抗匹配*
 - 并大串小Q相等，局部Q等于并阻比串阻减一再开根
= PN结二极管
- 端口方程：$i=I_"S0" (e^(-v_D/v_T)-1)$，其中 $I_"S0"$ 为pA量级，$v_T=(k T)/q$ 在室温下为 26 mV\
  可近似为 $i=I_"S0"exp(-v_D/v_T)$，微分电阻 $r_d=((dif i)/(dif v))^(-1)_Q=v_T/I_0$
- 抽象：导通0.7 V戴维南源/恒压源、理想整流模型
- 半波整流：单端直接接，$V_"dc"=1/pi V_p, V_"rms"=1/2 V_p, #h(13pt) V'_p=V_p-V_"on"$，需要承受反向偏压 \
  全波整流：单端转双端，$V_"dc"=1/pi V_p, V_"rms"=1/(2sqrt(2)) V_p, V'_p=1/2V_p-V_"on"$ \
  桥式整流：双端四个管，$V_"dc"=2/pi V_p, V_"rms"=1/sqrt(2) V_p, #h(7pt) V'_p=V_p-2V_"on"$
- 析取直流：A. 大电容低通滤波，取平均值；\
  #h(5em) B. 快速充电、慢速放电，取极大值，纹波幅度 $Delta v=I_L/(f C)$
- 钳位器，并臂二极管，实现倍压整流
- 稳压二极管，工作于反向击穿区，可建模为恒压源/戴维南源；两个面对面对接，实现限幅电路
- 二极管+运放，可实现指数对数运算、半波信号产生
- 实际电路中判断正反偏的方法：先假设反偏截止（抠掉二极管），确认假设是否成立
= 晶体管
- MOSFET：通过控制导电沟道电荷密度控制电阻，$beta_n=1/2 mu_n C_(o x) (W/L)$，N型端口特性：
  $ i_D=f_(i v, D)(v_"GS", v_"DS") = cases(
    0 &space& v_"GS"<V_"TH"& "（截止区）",
    2beta_n (v_"GS"-V_"TH")v_"DS"-beta_n v_"DS"^2 && v_"GS">V_"TH"\,v_"GD">V_"TH"& "（欧姆导通区）",
    beta_n (v_"GS"-V_"TH")^2 && v_"GS">V_"TH"\,v_"GD"<V_"TH"& "（恒流/有源/饱和区）") $
  - 分段折线模型：
    - 截止区：开路模型；截止/欧姆区：受控开关模型
    - 欧姆区：受控线性电阻模型，$r_d=((dif i_D)/(dif v_"DS"))_(v_"DS"=0)^(-1)=1/(2beta_n (v_"GS"-v_"TH"))$ 
    - 恒流区：受控恒流源模型，$i_D=beta_n (v_"GS"-V_"TH")^2$
  - 二极管连接方式：导线连接漏栅，端口特性 $i=beta_n (v-V_"TH")^2$
  - 电流镜：模拟集成电路的特征电路（工艺偏差一致抵消），$matsmall(I_"D2"/I_"D1"=(W slash L)_1 / (W slash L)_2)$ #place(image("current_mirror.png", height: 100pt), right, dx: 120pt, dy: -100pt)
    加特定负载，需要验证此时M2是否满足恒流区条件
  - 分压偏置电路，漏极负反馈（压缩输出空间），通过灵敏度分析不确定性
    
- BJT：通过控制基区电子浓度电荷密度控制电阻；以 $i_B$ 为控制变量，N型恒流区端口特性：
  $ V_"BE"=V_T ln(I_B/I_"BS0"+1),I_C=beta I_B space.quad (V_"CE">V_"CE,sat") $
  - 分段折线模型：
    - 截止区：开路模型；截止/饱和区：受控开关模型
    - 饱和区：恒压源模型，$v_"BE"=V_"on", v_"CE"=V_"CE,sat"$ 
    - 恒流区：受控恒流源模型，$i_C=beta I_"B0" (1+V_"CE"/V_A)=I_"C0"+v_"CE"/r_"CE"$
  - 分压偏置电路，BJT关键参量β具有高度不确定性，需引入负反馈（并联/射极串联）
  - 电流镜，TODO
- 厄利效应：输出电流乘上因子 $(1+V_"DS/CE"/V_A)$
= 反相器与数字电路
反相器分析方法：
1. 图解法，定性分析，并得出各区工作条件
2. 解析法/分段折线近似，得出转移特性方程和曲线 
- CMOS反相器：以非线性电阻PMOS沟道电阻和直流偏置电压源为偏置电路，功耗低增益高
- CMOS数字电路
  - 逻辑和门电路实现：这不是我们《数字逻辑与处理器基础》的梗吗，后面忘了
  - 晶体管级逻辑电路：上P下N，串联与并联或，PMOS反向开关先求非，NMOS旁路开关后求非，最后加一级非门
  - 动态分析门电路延时：将所有寄生电容综合为负载电容，考虑阶跃信号的延时和升降时间
    - 极端抽象：假设以恒定的平均电流对电容充放电，且电容是线性时不变的
    - TODO

= 放大器
== 小信号放大
1. 直流分析，获得直流工作点
2. 交流小信号分析，取微分元件：线性电阻不变，电容/电感看情况短路/开路，直流源置零，非线性元件根据直流工作点计算微分增益，转化为微分小信号模型
 - 晶体管y参量小信号模型：（BJT）$g_m=I_"C0"/V_T,r_"be"=beta/g_m,r_"ce"=V_A/I_"C0"$\
   #h(11.2em) （MOS）$g_m=(2I_"D0")/V_"od",r_"ds"=V_A/I_"D0"$
- *三种组态*
  1. CE/CS：单向网络，压控流源模型，反相放大 $A_v~-g_m R_L, r_"in"=r_"be" slash infinity,r_"out"=r_"ce" slash r_"ds"$
  2. CB/CG：双向网络，同相电流缓冲器 \
    $A_v ~ g_"mf"R_L=(g_m R_L)/(1+g_m R_S), r_"in"=r_"be"||(r_"ce"+R_L)/(1+g_m r_"ce") ~ 1/g_m, r_"out"=(r_"be"||R_S) angle.l g_m angle.r r_"ce" ~ infinity  $
  3. CC/CD：双向网络，同相电压缓冲器 \
    $A_v ~ g_"mf"R_L=(g_m R_L)/(1+g_m R_L), r_"in"=r_"be" angle.l g_m angle.r (r_"ce"||R_L) ~ infinity, r_"out"=r_"ce"||(r_"be"+R_S)/(1+g_m r_"be") ~ 1/g_m$
- *频率特性*
  - 只需掌握到三个频点相加/倒数相加，近似估计，差别越大估计越准确
  - 低端 3 dB 频点：分别看三个电容各自看到的电阻，其他电容短路，算出频点后相加\
    决定性因素：$f_"0,E"=1/(2pi C_E) (1 slash (1/g_m||R_E)) approx g_m/(2pi C_E)$
  - 高端 3 dB 频点：分别看三个电容各自看到的电阻，其他电容开路，算出时间常数后相加\
    决定性因素：$tau_"bc"=C_"bc" dot R'_S angle.l g_m angle.r R'_L$（米勒效应：小电容大作用）
  - 影响：有源性失却；产生负阻导致不稳定
== 大信号放大
- 高增益方案：
  1. 有源负载，通过偏置在恒流区的晶体管提供极大的交流电阻，$A_"v0"=-g_m (r_"ds1"||r_"ds_2")$
  2. 缓冲隔离负载，共漏/共集组态的电压缓冲器，提供驱动重负载的能力
  3. 级联放大
- *输出级（电压缓冲器）*
  - A类放大器：通过大的直流偏置电流确保线性输出，输出最大摆幅 $plus.minus I_Q R_L$\
    #h(6em)为实现大信号（大摆幅），需要大偏置电流，能耗高，晶体管偏置 $eta_max=25%$，\
    #h(6em)高频扼流圈偏置 $eta_max=50%$
  - AB类放大器：推挽结构，调节两管间偏置电压使其微微导通：\
   #h(6.8em)输入信号正半周，Q1导通，Q2近乎截止；\
   #h(6.8em)输入信号负半周，Q2导通，Q1近乎截止；\
   #h(6.8em)$I_"PUSH" dot I_"PULL"=C$，效率介于A与B（无偏置电压，$eta_max=pi/4$，交越失真）之间
  - 直流/交流功率相关
  $ cases(U&=U_0+U_1sin(omega t)+U_2 sin(2omega t)+dots,
  I&=I_0+I_1sin(omega t+phi_1)+I_2 sin(2omega t+phi_2)+dots) $
  $ cases(P_"DC"=P_0=U_0I_0,P_"AC"=sum_(i>=1) P_i=sum_(i>=1)(|cos phi_i|)/2U_i I_i) $
- *差分对*
  - 差模与共模
  $ cases(v_"ic"&=1/2(v_"ip"+v_"in"), v_"id"&=v_"ip"-v_"in"), cases(v_"ip"&=v_"ic"+1/2v_"id", v_"in"&=v_"ic"-1/2v_"id") \
   v_o=A_"dd"v_"id"+A_"dc"v_"ic", "共模抑制比" "CMRR"=20lg abs(A_"dd"/A_"dc") $
  - 共模输入范围：两管不到欧姆区/饱和区，$v_"GD"<V_"TH"$ / $v_D>v_B$
  - 差模输入范围：由差模转移特性直接推，BJT当作$v_"id"=±4.6v_T$截止
  $ i_d=I_"SS" v_"id"/V_"od0"sqrt(1-1/4(v_"id"/V_"od0")^2)"（MOS）"I_"EE"tanh v_"id"/(2v_T)"（BJT）" $
  - 小信号分析：$g_m, r_"ds"$ 根据小信号模型直接算，$A_"vd"=g_"m0" (r_"ds"||R_D)$
  - 双端转单端：加电流镜，考虑负载电阻，$A_"vd"=g_"m0" (r_"ds2"||r_"ds4")$
= 反馈
== 负反馈
- 理解性记忆：串联检测电流/形成电压，导致电阻小，开环置零即检测不到电流，开路；\
  #h(6em)   并联检测电压/形成电流，导致电阻大，开环置零即检测不到电压，短路；
== 正反馈
#place(image("schdmit_trigger.png", height: 90pt), right, dy: -10pt)
- 运放正反馈构成施密特触发器，形成滞回特性曲线
 - 在此基础上添加负反馈电阻R，形成S型负阻
  - 加流测试形成S形曲线，加压测试形成滞回曲线
  - 中间段为 $-R R_1/R_2$ 负阻，两侧为内阻 $R$ 的戴维南源
 - 交换运放正负端，则形成N形负阻
- 晶体管正反馈 
  - #place(image("shockley_diode.png", height: 2em), top, dx: 100%-2em, dy: -0.8em) 肖克利二极管：S型负阻，两BJT正反馈连接，电路符号：\
    高阻/负阻/低阻区，高/低阻实现有记忆开关
  - 反相器级联并正反馈连接，形成N型负阻，即SRAM，用于存储
  - 隧道二极管，N型负阻，电路符号：#box($-#h(-1pt)triangle.r.filled #h(-2pt) bracket.r #h(-2pt) -$, baseline: -1pt)
= 振荡器
- 负阻振荡
 - \*正弦振荡：负欠阻尼振荡（串/并联）（基本不用，只对付填空题）
  - 起振条件：$r slash g_n>R_s slash G_p$；平衡条件：$r slash g_n=R_s slash G_p$；稳定条件：$(dif r slash g_n)/(dif x)<0$
  - 负阻振荡原理以LC谐振腔为主体，频率条件自然满足
 - 张弛振荡：由正弦振荡Q值很低时退化
  - $display(Delta_t=tau ln (V_"终"-V_"初")/(V_"终"-V_"转"))$
- 正反馈振荡
 - 起振条件：$abs(A F)>1$（幅度条件）$phi(omega)=0$（频率/相位条件）
 - 平衡条件：$abs(A F)=1$
 - 稳定条件：平衡点处 $(dif abs(A F))/(dif V)<0$（幅度条件）$(dif phi(omega))/(dif omega)<0$（频率条件）
- 正反馈分析方法
 1. 把环路中的理想受控源作为放大网络（注意抽取方法），剩下都作为反馈网络处理
 2. 求放大倍数和反馈系数，由相位条件确定振荡频率，由幅度条件确定起振条件
 #image("positive.png", height: 50pt)
- 三点式振荡器
 - 等效分析：串转并，即阻抗匹配；全接入等效，接入系数 $p$ 即分压系数，$R'=1/p^2 R$